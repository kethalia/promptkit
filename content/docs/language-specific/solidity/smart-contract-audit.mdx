---
title: "Smart Contract Security Audit"
description: "Perform a comprehensive security audit of Solidity smart contracts, identifying vulnerabilities and providing prioritized remediation guidance."
---

# Smart Contract Security Audit

Perform a comprehensive security audit of Solidity smart contracts, identifying vulnerabilities and providing prioritized remediation guidance.

---

## Context

Gather the following before starting the audit:

1. **Contract source code** - All Solidity files in scope
2. **Solidity version** - Check pragma statements (pre-0.8 requires extra overflow checks)
3. **Contract architecture** - Identify if upgradeable (proxy pattern), inherited contracts
4. **External dependencies** - OpenZeppelin, other libraries in use
5. **Deployment context** - Mainnet, L2, expected TVL, privileged roles
6. **Previous audits** - Any existing audit reports or known issues

## Instructions

### 1. Reentrancy Analysis
- Identify all external calls (`.call`, `.transfer`, `.send`, contract calls)
- Check state changes after external calls (CEI pattern violations)
- Review cross-function and cross-contract reentrancy paths
- Flag any callback patterns (ERC721 `onERC721Received`, ERC1155, etc.)
- **SWC-107**: Reentrancy

### 2. Arithmetic Issues (Pre-0.8)
- For Solidity versions before 0.8: Check all arithmetic operations for overflow/underflow
- Verify SafeMath usage or equivalent
- Review casting operations (uint256 to uint128, etc.)
- **SWC-101**: Integer Overflow and Underflow

### 3. Access Control Review
- Map all privileged functions and their modifiers
- Check for missing access controls on sensitive functions
- Review role-based access (OpenZeppelin AccessControl, Ownable)
- Verify initializer protection in upgradeable contracts
- Check for centralization risks (single owner, no timelock)
- **SWC-105**: Unprotected Ether Withdrawal
- **SWC-106**: Unprotected SELFDESTRUCT

### 4. Front-Running Vulnerabilities
- Identify commit-reveal patterns (or lack thereof)
- Check for price manipulation via transaction ordering
- Review DEX interactions, oracle usage
- Slippage protection in swaps
- **SWC-114**: Transaction Order Dependence

### 5. Flash Loan Attack Vectors
- Identify price oracle dependencies
- Check for single-block manipulation vulnerabilities
- Review liquidity assumptions
- Verify TWAP or multi-block price feeds where needed

### 6. External Call Safety
- Review all `.call`, `.delegatecall`, `.staticcall` usage
- Check return value handling (unchecked return values)
- Verify target address validation
- Review `delegatecall` to untrusted contracts
- **SWC-104**: Unchecked Call Return Value
- **SWC-112**: Delegatecall to Untrusted Callee

### 7. Storage and Upgrade Safety (If Proxy)
- Verify storage layout compatibility between versions
- Check for storage collisions in proxy patterns
- Review initializer functions (no constructor reliance)
- Validate upgrade authorization
- Check `__gap` variables for future storage
- **SWC-124**: Write to Arbitrary Storage Location

### 8. Events and Error Handling
- Verify events emitted for all state changes
- Check custom errors vs require strings (gas efficiency)
- Review error messages for information leakage
- Ensure critical operations are logged

### 9. Gas Limit and DoS
- Identify unbounded loops
- Check array operations that grow over time
- Review pull vs push payment patterns
- **SWC-128**: DoS With Block Gas Limit
- **SWC-113**: DoS with Failed Call

### 10. Additional Checks
- Timestamp dependence (**SWC-116**)
- Signature malleability (**SWC-117**, **SWC-121**)
- Floating pragma (**SWC-103**)
- Uninitialized storage pointers (**SWC-109**)
- tx.origin authentication (**SWC-115**)

## Output Format

### Executive Summary
Brief overview of contract security posture and critical findings count.

### Findings Table

| ID | Title | Severity | Category | Status |
|----|-------|----------|----------|--------|
| H-01 | ... | High | Reentrancy | Open |

### Detailed Findings

For each finding:

```
### [SEVERITY-ID] Title

**Severity:** Critical / High / Medium / Low / Informational
**Category:** [e.g., Reentrancy, Access Control]
**SWC Reference:** SWC-XXX (if applicable)

**Location:** `ContractName.sol#L42-L50`

**Description:**
[Detailed explanation of the vulnerability]

**Impact:**
[What an attacker could achieve]

**Proof of Concept:**
[Code or steps to reproduce]

**Recommendation:**
[Specific code changes to fix]
```

### Severity Definitions
- **Critical**: Direct fund loss, contract takeover
- **High**: Significant fund loss possible, severe functionality break
- **Medium**: Limited fund loss, important functionality affected
- **Low**: Minor issues, best practice violations
- **Informational**: Suggestions, code quality

## Interactive Decisions

1. **Scope clarification**: Which contracts are in scope? Are tests/mocks excluded?
2. **Threat model**: What are the trusted roles? What's the expected TVL?
3. **Known issues**: Are there any acknowledged risks to exclude?
4. **Upgrade context**: Is this an upgrade? Provide previous version for storage comparison.
5. **Remediation review**: After fixes, should findings be re-verified?
